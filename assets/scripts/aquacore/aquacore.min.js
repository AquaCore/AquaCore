var AquaCore=AquaCore||{};(function(a){AquaCore=a.extend({id:0,TIME_OFFSET:0,URL:"",REWRITE:false,DIR:"",BASE_DIR:"",SCRIPT_NAME:"",settings:{},language:{words:{},direction:"LTR"}},AquaCore,true);AquaCore.language.extend=function(c,b){this.words[c]=this.words[c]||{};a.extend(this.words[c],b)};AquaCore.language.namespace=function(b){return(this.words.hasOwnProperty(b)?this.words[b]:{})};AquaCore.l=function(d,c){var b;if(this.language.namespace(d).hasOwnProperty(c)){c=this.language.words[d][c]}else{return c}b=Array.prototype.splice.call(arguments,2);if(b.length){b.unshift(c);c=sprintf.apply(null,b)}return c};AquaCore.getDate=function(b){if(!(b instanceof Date)){b=new Date(b)}return new Date(b.getTime()+(b.getTimezoneOffset()*60000)+(AquaCore.TIMEOFFSET*60000))};AquaCore.prototype={id:null,events:{},options:{},uniqueId:function(){this.id=this.id||++AquaCore.id;return("aquacore-n-"+this.id)},option:function(b,c){if(typeof b==="object"){this.options=a.extend({},this.options,b);return this}else{if(typeof c!=="undefined"){this.options[b]=c;return this}else{return this.options[b]}}},bind:function(b,c){this.events[b]=this.events[b]||[];this.events[b].push(c);return this},trigger:function(e,c){if(!this.events.hasOwnProperty(e)||this.events[e].length<1){return null}var d,b=null;c=c||[];for(d=0;d<this.events[e].length;++d){b=this.events[e][d].apply(this,c);if(b===false){return false}}return b}};AquaCore.buildUrl=function(c){var b="";c=a.extend({protocol:window.location.protocol+"//",domain:window.location.host||window.location.hostname,username:null,password:null},c);if(c.protocol){b+=c.protocol}if(c.username){b+=c.username;if(c.password){b+=":"+c.password}b+="@"}b+=c.domain.replace(/(\/)+$/g,"");b+=this.buildPath(c);return b};AquaCore.buildPath=function(b){var e="/",d=false;b=a.extend({urlRewrite:AquaCore.REWRITE,baseDir:AquaCore.BASE_DIR+"/"+AquaCore.DIR,script:AquaCore.SCRIPT_NAME,path:[],action:"index","arguments":[],query:{},hash:null},b);if(b.baseDir&&b.baseDir!=="/"){e+=b.baseDir.replace(/(\/+)$/g,"").replace(/^(\/+)/g,"")+"/";d=true}if(b.script&&b.script!=="index.php"){e+=b.script.replace(/(\/+)$/g,"").replace(/^(\/+)/g,"");d=false}if(b.urlRewrite){b.path.map(encodeURIComponent);b.arguments.map(encodeURIComponent);if(b.path.length){if(!d){d=true;e+="/"}e+=b.path.join("/")+"/"}if((b.action&&b.action!=="index")||b.arguments.length){if(!d){d=true;e+="/"}e+="action/"+encodeURIComponent(b.action||"index")+"/";if(b.arguments.length){e+=b.arguments.join("/")+"/"}}}else{var c={};if(b.path.length){c.path=b.path.join(".")}if(b.action&&b.action!=="index"){c.action=b.action}if(b.arguments.length){c.arg=b.arguments.join(".")}b.query=a.extend(c,b.query)}e+=this.buildQuery(b.query).replace(/&+$/g,"");if(b.hash){e+="#"+b.hash}return e};AquaCore.buildQuery=function(b){var d="";for(var c in b){if(!b.hasOwnProperty(c)){continue}d+=encodeURIComponent(c);if(a.isArray(b[c])){d+="=";b[c].map(encodeURIComponent);d=b[c].join("&")}else{if(b[c]){d+="="+encodeURIComponent(b[c])}}d+="&"}if(d){return"?"+d}else{return""}};AquaCore.Flash=function(c){var b=this;this.option(c);this.options.queue++;this.element=document.createElement("div");a(this.element).addClass("ac-flash-messages").appendTo(this.options.appendTo||document.body).bind("mouseenter",function(){if(b.messages.length){b.stop()}}).bind("mouseleave",function(){if(b.messages.length){b.start()}})};AquaCore.Flash.prototype=a.extend({},AquaCore.prototype,{element:null,timeout:null,interval:null,messages:[],options:{timeout:2000,interval:4000,queue:5,appendTo:null,messageOptions:{},hide:{},show:{}},enqueue:function(e,g,f){if(!e){return this}else{if(a.isArray(e)){for(var d=0;d<e.length;++d){this.enqueue(e[d]["type"],e[d]["title"],e[d]["message"])}return this}}var c=new AquaCore.FlashMessage(e,g,f,this.options.messageOptions);if(this.trigger("enqueue",[c])!==false){var b=this;c.bind("afterClose",function(){b.dequeue(this)});this.messages.push(c);a(this.element).append(c.element);if(!this.options.queue||this.messages.length<this.options.queue){c.show()}else{a(c.element).css("display","none")}this.show();this.startTimeout()}else{delete (c)}return this},dequeue:function(c){var d=this.pos(c);if(d<0){return this}if(this.trigger("dequeue",[this.messages[d]])!==false){this.element.removeChild(this.messages[d].element);if(this.messages.length===0){this.stop();this.hide()}else{if(this.messages.length>this.options.queue){var b=this;this.messages[this.options.queue-1].show();a(this.messages[this.options.queue-1].element).promise().done(function(){b.start()})}else{this.start()}}delete (this.messages[d]);this.messages.splice(d,1)}return this},clear:function(){for(var b=0;b<this.messages.length;++b){this.dequeue(this.messages[b])}return this},pos:function(b){for(var c=0;c<this.messages.length;++c){if(b.uniqueId()===this.messages[c].uniqueId()){return c}}return -1},next:function(){if(this.messages.length===0){return this}var d,c=null;d=this.messages[0];this.stop();if(this.trigger("next",[d])!==false){var b=this;d.hide(function(){b.dequeue(d)})}return this},show:function(b){if(a(this.element).is(":hidden")&&this.trigger("show")!==false){a(this.element).show(a.extend({complete:function(){self.trigger("afterShow");if(b){b.apply(this,arguments)}}},this.options.show))}return this},hide:function(){if(a(this.element).is(":visible")&&this.trigger("hide")!==false){a(this.element).hide(a.extend({complete:function(){self.trigger("afterHide");if(callback){callback.apply(this,arguments)}}},this.options.show))}return this},stop:function(){if(this.trigger("stop")!==false){if(this.timeout){clearTimeout(this.timeout);this.timeout=null}if(this.interval){clearInterval(this.interval);this.interval=null}}return this},start:function(){if(!this.interval&&!this.trigger("start")!==false){var b=this;this.interval=setInterval(function(){b.next()},b.options.interval)}return this},startTimeout:function(){if(!this.timeout&&!this.interval){var b=this;this.timeout=setTimeout(function(){b.start()},this.options.timeout)}return this}});AquaCore.FlashMessage=function(d,f,e,c){var b=this;this.option(c);this.type=d||"notification";this.title=f||"";this.message=e||"";this.element=document.createElement("div");this.button=document.createElement("div");this.messageContainer=document.createElement("div");this.titleContainer=document.createElement("div");a(this.element).addClass("ac-flash").addClass("ac-flash-type-"+this.type).attr("id",this.uniqueId());a(this.titleContainer).addClass("ac-flash-title").appendTo(this.element);a(this.messageContainer).addClass("ac-flash-message").html(e).appendTo(this.element);a(this.button).addClass("ac-flash-close").appendTo(this.element);a(this.button).bind("click",function(){b.close()});if(!f){a(this.titleContainer).css("display","none")}};AquaCore.FlashMessage.prototype=a.extend({},AquaCore.prototype,{type:"notification",title:null,message:null,element:null,button:null,titleContainer:null,messageContainer:null,options:{show:{effect:"blind",easing:"easeInOutCirc",duration:400},hide:{effect:"blind",easing:"easeInOutCirc",duration:400}},events:{},setTitle:function(b){this.title=b;this.titleContainer.innerHTML=b;if(b){a(this.titleContainer).css("display","")}else{a(this.titleContainer).css("display","none")}return this},setMessage:function(b){this.message=b;a(this.messageContainer).html(b);return this},hide:function(c){if(this.trigger("hide")!==false){var b=this;a(this.element).hide(a.extend({complete:function(){b.trigger("afterHide");if(c){c.apply(this,arguments)}}},this.options.hide))}return this},show:function(c){if(this.trigger("show")!==false){var b=this;a(this.element).show(a.extend({complete:function(){b.trigger("afterShow");if(c){c.apply(this,arguments)}}},this.options.show))}return this},close:function(c){if(this.trigger("close")!==false){var b=this;a(this.element).hide(a.extend({complete:function(){b.trigger("afterClose");if(c){c.apply(this,arguments)}}},this.options.hide))}return this}});AquaCore.bbCode={};AquaCore.bbCode.spoiler=function(c,d){var b=this;this.button=c;this.content=d;console.log(c,d);a(this.button).bind("click",function(f){b.toggle();f.preventDefault()})};AquaCore.bbCode.spoiler.prototype=a.extend({},AquaCore.prototype,{button:null,content:null,options:{hide:{effect:"blind",easing:"easeInOutCirc",duration:200},show:{effect:"blind",easing:"easeInOutCirc",duration:200}},toggle:function(){if(a(this.content).is(":hidden")){this.show()}else{this.hide()}},hide:function(c){if(this.trigger("hide")!==false){var b=this;a(this.button).removeClass("active");a(this.content).stop(true,false).hide(a.extend({complete:function(){b.trigger("afterHide");if(c){c.apply(this,arguments)}}},this.options.hide))}return this},show:function(c){if(this.trigger("show")!==false){var b=this;a(this.button).addClass("active");a(this.content).stop(true,false).show(a.extend({complete:function(){b.trigger("afterShow");if(c){c.apply(this,arguments)}}},this.options.show))}return this}},true);AquaCore.cart=function(b){this.option(b);this.element=document.createElement("div");this.element.clasName="ac-cart";this.itemList=document.createElement("ul")};AquaCore.cart.prototype=a.extend({items:[],priceTotal:0,element:null,itemList:null,options:{checkoutUrl:null,appendTo:null},add:function(c,b,f,d){var e=new AquaCore.cartItem(c,b,f,amoune)},remove:function(c,b,e,d){},calcPrice:function(){var c=0;for(var b=0;b<this.items.length;++b){c+=this.items[b].price*this.items[b].amount}this.priceTotal=c;this.fire("calculatePrice");this.priceContainer.innerHTML(AquaCore.l("donation","credit-points",c.format()))},show:function(b){},hide:function(b){}},AquaCore.prototype);AquaCore.cartItem=function(f,d,c){var b=this,e;this.element=document.createElement("div");this.element.className="ac-cart-item";this.element.id=this.uniqueId();this.amountContainer=document.createElement("div");this.amountContainer.className="ac-cart-item-amount";e=document.createElement("img");e.src=AquaCore.URL+"/assets/images/item/icon/"+f+".png";this.watch("amount",function(i,g,h){b.set(h)})};AquaCore.cartItem.prototype=a.extend({itemId:null,itemName:null,amount:0,price:0,element:null,amountContainer:null,set:function(b){if(b!==this.amount){this.amount=b}a(".ac-item-amount",this.element).html(b.format());return this}},AquaCore.prototype);AquaCore.ExperienceSlider=function(d,c){var b=this;this.option(c);this.element=d;this.currentLevel=this.options.level;this.slider=document.createElement("div");this.info=document.createElement("div");this.min=Math.max(0,this.options.level-11);this.max=this.options.level+31;a(this.info).addClass("ac-renewal-exp-info").appendTo(this.element);a(this.slider).addClass("ac-renewal-exp-slider").appendTo(this.element).slider(a.extend({},this.options.slider,{min:Math.max(1,this.options.level-11),max:this.options.level+31,value:this.currentLevel,change:function(g,f){b.currentLevel=f.value;b.updateUi()}}));this.updateUi()};AquaCore.ExperienceSlider.prototype=a.extend({},AquaCore.prototype,{currentLevel:null,element:null,slider:null,info:null,options:{format:"Level: :level (:rate%)",level:1,experience:[],slider:{}},level:function(b){if(typeof b!=="undefined"){this.currentLevel=b;a(this.slider).slider("value",b)}return this.currentLevel},updateUi:function(d){var b,c;d=d||this.currentLevel;c=d-this.options.level;if(c<-10){d="&lt;"+(d+1);b=40}else{if(c===-10){b=140}else{if(c===-9){b=135}else{if(c===-8){b=130}else{if(c===-7){b=125}else{if(c===-6){b=120}else{if(c===-5){b=115}else{if(c===-4){b=110}else{if(c===-3){b=105}else{if(c>=-2&&c<=5){b=100}else{if(c>=6&&c<=10){b=95}else{if(c>=11&&c<=15){b=90}else{if(c>=16&&c<=20){b=85}else{if(c>=21&&c<=25){b=60}else{if(c>=26&&c<=30){b=35}else{d="&gt;"+(d-1);b=10}}}}}}}}}}}}}}}a.each(this.options.experience,function(){var e=a(this);e.text(Math.floor((parseInt(e.attr("ac-original-exp"))/100)*b).format())});a(this.info).html(this.options.format.replace(":level",d).replace(":rate",b))}});AquaCore.AjaxForm=function(d,c){var b=this;this.option(c);this.submitting=false;this.button=null;this.data=null;this.form=d;a("[type=submit]",this.form).bind("click",function(){b.button=this});a(this.form).bind("submit",function(f){b.submit(f)})};AquaCore.AjaxForm.prototype=a.extend({},AquaCore.prototype,{options:{cache:false,async:false,beforeSend:null,complete:null,success:null,error:null},hasFiles:function(){return Boolean(a("input[type=file]",this.form).val())},submit:function(k){var c=this,h=[],f={},b,g;if(this.submitting){k.preventDefault();k.stopPropagation();return false}if(this.hasFiles()){if(typeof window.FormData!=="undefined"){h=new FormData}else{return true}}k.preventDefault();k.stopPropagation();this.submitting=true;b=a("input, select, button, textarea",this.form);if(a(this.form).attr("id")){a.merge(b,a('[form="'+a(this.form).attr("id")+'"]'))}for(g=0;g<b.length;++g){if(!b.eq(g).attr("name")||b.eq(g).attr("type")==="submit"||((b.eq(g).attr("type")==="checkbox"||b.eq(g).attr("type")==="radio")&&!b.eq(g).is(":checked"))){continue}if(a.isArray(h)){h.push({name:b.eq(g).attr("name"),value:b.eq(g).val()})}else{if(b.eq(g).attr("type")==="file"){if(b[g].files.length===1){h.append(b.eq(g).attr("name"),b[g].files[0])}else{for(var d=0;d<b[g].files.length;++d){h.append(b.eq(g).attr("name")+"["+d+"]",b[g].files[d])}}}else{h.append(b.eq(g).attr("name"),b.eq(g).val())}}}if(this.button&&a(this.button).attr("name")){if(a.isArray(h)){h.push({name:a(this.button).attr("name"),value:a(this.button).val()})}else{h.append(a(this.button).attr("name"),a(this.button).val())}}f.data=h;if(a(this.form).attr("method")){f.type=a(this.form).attr("method")}if(a(this.form).attr("action")){f.url=a(this.form).attr("action")}if(!a.isArray(h)){f.processData=false;f.contentType=false;f.mimeType="multipart/form-data"}a.ajax(a.extend(f,this.options,{beforeSend:function(i,e){if(c.options.beforeSend){return c.options.beforeSend.call(c,i,e)}},complete:function(i,e){c.button=null;c.submitting=false;if(c.options.complete){return c.options.complete.call(c,i,e)}},success:function(j,e,i){if(c.options.success){return c.options.success.call(c,j,e,i)}},error:function(j,e,i){if(c.options.error){return c.options.error.call(c,j,e,i)}}}));return false}})}(jQuery));